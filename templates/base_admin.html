{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="Responsive Admin &amp; Dashboard Template based on Bootstrap 5">
	<meta name="author" content="AdminKit">
	<meta name="keywords" content="adminkit, bootstrap, bootstrap 5, admin, dashboard, template, responsive, css, sass, html, theme, front-end, ui kit, web">

	<link rel="preconnect" href="{% static 'https://fonts.gstatic.com' %}">
	<link rel="shortcut icon" href="{% static 'img/logo.jpg' %}" />

	<link rel="canonical" href="{% static 'https://demo-basic.adminkit.io/' %}" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

	<title>ALMAQUA</title>

	<link href="{% static 'css/app.css' %}" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

	<!-- DataTables CSS Bootstrap 5 -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css" />

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>

<!-- DataTables JS -->
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>

<!-- DataTables Bootstrap 5 JS -->
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

	<style>
		
/* Perbaiki bullet list pagination yang muncul */
.dataTables_wrapper .dataTables_paginate {
  display: flex !important;
  justify-content: flex-end !important;
  padding: 0;
  margin: 0;
  list-style: none;
}

.dataTables_wrapper .dataTables_info {
  padding-top: 0.5rem;
}

/* Jika ada bullet atau tanda aneh di bawah pagination */
.dataTables_wrapper .dataTables_paginate ul {
  list-style: none !important;
  margin: 0 !important;
  padding: 0 !important;
}

table.dataTable {
  width: 100% !important;
}

.dataTables_wrapper .dataTables_paginate {
  margin-top: 1rem;
}

.dataTables_wrapper .dataTables_paginate .paginate_button {
  padding: 0.2rem 0.5rem;
  margin-left: 0.1rem;
  margin-right: 0.1rem;
  border-radius: 0.25rem;
}

.dataTables_wrapper .dataTables_paginate .paginate_button.current {
  background-color: #0d6efd;
  color: white !important;
}

.dataTables_wrapper .dataTables_paginate .paginate_button:hover {
  background-color: #0b5ed7;
  color: white !important;
}

/* Beri jarak antar alert jika ada lebih dari satu */
.alert + .alert {
  margin-top: 0.75rem;
}

/* Padding dan border-radius lebih smooth */
.alert {
  padding: 1rem 1.25rem;
  border-radius: 0.4rem;
  box-shadow: 0 2px 8px rgb(0 0 0 / 0.1);
  font-size: 1rem;
  font-weight: 500;
}

/* Animasi muncul dan hilang alert */
.alert.fade {
  opacity: 0;
  transition: opacity 0.3s ease-in-out;
}
.alert.show {
  opacity: 1;
}

/* Tombol close lebih besar dan rapih */
.alert .btn-close {
  opacity: 0.7;
  font-size: 1.1rem;
  margin-top: -0.2rem;
}
.alert .btn-close:hover {
  opacity: 1;
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  75% { transform: translateX(-4px); }
  75% { transform: translateX(4px); }
  75% { transform: translateX(-4px); }
}
.shake-icon {
    display: inline-block;
    animation: shake 0.7s infinite;
}
/* Garis pemisah antar menu */
/* garis pemisah antar item */
.sidebar-item {
  border-bottom: 1px solid #2c3e50; /* abu-abu gelap */
}

/* hover */
.sidebar-item > .sidebar-link:hover {
  background-color: #0d6efd;
  color: #fff;
}

/* active */
.sidebar-item.active > .sidebar-link {
  background-color: #0b5ed7; /* sedikit lebih gelap biar beda dengan hover */
  color: #fff;
  border-left: 4px solid #0a58ca; /* garis kiri tegas */
}




	</style>
	<!-- DataTables CSS Bootstrap 5 -->
<link href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css" rel="stylesheet" />
 <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


	
</head>

<body>
	<div class="wrapper">
<!-- Sidebar -->
<nav id="sidebar" class="sidebar js-sidebar">
  <div class="sidebar-content js-simplebar">
    <a class="sidebar-brand" href="">
      <span class="align-middle">ALMAQUA</span>
    </a>

    <ul class="sidebar-nav">
      <!-- Dashboard -->
      <li class="sidebar-header">Dashboard</li>
      <li class="sidebar-item {% if request.resolver_match.url_name == 'admin_dashboard' %}active{% endif %}">
        <a class="sidebar-link" href="{% url 'admin_dashboard' %}">
          <i class="bi bi-house-add-fill"></i>
          <span class="align-middle">Dashboard</span>
        </a>
      </li>

      <!-- Data Master -->
      <li class="sidebar-header">Data Master</li>
      <li class="sidebar-item {% if request.resolver_match.url_name == 'list_pelanggan' %}active{% endif %}">
        <a class="sidebar-link" href="{% url 'list_pelanggan' %}">
          <i class="align-middle" data-feather="users"></i>
          <span class="align-middle">Data Pelanggan</span>
        </a>
      </li>
      <li class="sidebar-item {% if request.resolver_match.url_name == 'list_pesanan' %}active{% endif %}">
        <a class="sidebar-link" href="{% url 'list_pesanan' %}">
          <i class="align-middle" data-feather="shopping-cart"></i>
          <span class="align-middle">Data Pesanan</span>
        </a>
      </li>

      <!-- Seleksi Moora -->
      <li class="sidebar-header">Seleksi Moora</li>
      <li class="sidebar-item {% if request.resolver_match.url_name == 'list_nilai' %}active{% endif %}">
        <a class="sidebar-link" href="{% url 'list_nilai' %}">
          <i class="align-middle" data-feather="bar-chart-2"></i>
          <span class="align-middle">Nilai Alternatif</span>
        </a>
      </li>
      <li class="sidebar-item {% if request.resolver_match.url_name == 'hasil_moora' %}active{% endif %}">
        <a class="sidebar-link" href="{% url 'hasil_moora' %}">
          <i class="align-middle" data-feather="trending-up"></i>
          <span class="align-middle">Perhitungan MOORA</span>
        </a>
      </li>
      

      <!-- Pengaturan -->
      <li class="sidebar-header">Pengaturan</li>
      <li class="sidebar-item {% if request.resolver_match.url_name == 'profile' %}active{% endif %}">
        <a class="sidebar-link" href="{% url 'profile' %}">
          <i class="align-middle" data-feather="settings"></i>
          <span class="align-middle">Data Pengguna</span>
        </a>

      </li>

      <!-- Logout -->
      <li class="sidebar-item">
        <a href="{% url 'logout' %}"
           class="btn btn-danger w-100 d-flex align-items-center justify-content-center">
          <i class="align-middle me-2" data-feather="log-out"></i>
          <span>Logout</span>
        </a>
      </li>
    </ul>
  </div>
</nav>


  <!-- Main -->
  <div class="main">
    <!-- Navbar -->
    <nav class="navbar navbar-expand navbar-light navbar-bg">
      <a class="sidebar-toggle js-sidebar-toggle">
        <i class="hamburger align-self-center"></i>
      </a>

      <!-- Marquee Selamat Datang -->
<div class="flex-grow-1 px-3">
  <marquee behavior="scroll" direction="left" scrollamount="5"
           class="fw-semibold text-primary">
    Selamat datang, {{ request.user.get_full_name|default:request.user.username }} (Admin)
    di Sistem Pendukung Keputusan - MOORA
  </marquee>
</div>


      <!-- Profil -->
      <div class="navbar-collapse collapse">
        <ul class="navbar-nav navbar-align">
          <li class="nav-item dropdown">
            <a class="nav-icon dropdown-toggle d-inline-block d-sm-none"
               href="#" data-bs-toggle="dropdown">
              <i class="align-middle" data-feather="settings"></i>
            </a>
            <a class="nav-link d-none d-sm-inline-block"
               href="#" data-bs-toggle="dropdown">
              <i class="bi bi-person-circle fs-4 me-1"></i>
              <span class="text-dark">{{ request.user.username }}</span>
              <span id="current-time"
                    class="text-muted ms-3"
                    style="font-weight: normal; font-size: 0.9rem;"></span>
            </a>
          </li>
        </ul>
      </div>
    </nav>

    <!-- Content -->
    <main class="content">
      <div class="container mt-3">
        {% if messages %}
          {% for message in messages %}
            {% if message.tags == 'success' %}
              <script>
                Swal.fire({
                  icon: 'success',
                  title: 'Berhasil!',
                  text: '{{ message }}',
                  timer: 2000,
                  showConfirmButton: false
                });
              </script>
            {% endif %}
          {% endfor %}
        {% endif %}
        <!-- Alert messages -->
    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    {% endif %}

        {% block content %}
          <!-- konten lain -->
        {% endblock %}
      </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="container-fluid">
        <div class="row text-muted justify-content-between align-items-center">
          <div class="col-auto">
            <p class="mb-0">
              Sistem Pendukung Keputusan berbasis <strong>MOORA</strong> &copy; 2025.
            </p>
          </div>
          <div class="col-auto">
            <p class="mb-0">
              Dibangun oleh
              <a href="https://github.com/dina" target="_blank" class="text-muted">
                <strong>Dina</strong>
              </a>
            </p>
          </div>
        </div>
      </div>
    </footer>
  </div>
</div>



	<script src="{% static 'js/app.js' %}"></script>

	
	<script>
		document.addEventListener("DOMContentLoaded", function() {
			var date = new Date(Date.now() - 5 * 24 * 60 * 60 * 1000);
			var defaultDate = date.getUTCFullYear() + "-" + (date.getUTCMonth() + 1) + "-" + date.getUTCDate();
			document.getElementById("datetimepicker-dashboard").flatpickr({
				inline: true,
				prevArrow: "<span title=\"Previous month\">&laquo;</span>",
				nextArrow: "<span title=\"Next month\">&raquo;</span>",
				defaultDate: defaultDate
			});
		});
	</script>
	<script>
  function updateTime() {
    const now = new Date();
    // Format jam: HH:MM:SS
    const timeString = now.toLocaleTimeString('id-ID', { hour12: false });
    document.getElementById('current-time').textContent = timeString;
  }
  
  document.addEventListener('DOMContentLoaded', function() {
    updateTime(); // tampilkan langsung saat load
    setInterval(updateTime, 1000); // update tiap detik
  });
</script>
<!-- jQuery (DataTables butuh jQuery) -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>

<!-- DataTables JS -->
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
  ...
  <script>
	$.fn.dataTable.ext.errMode = 'none';

    $(document).ready(function () {
      $('#pelangganTable').DataTable({
        // opsi sesuai keinginan
      });
    });

	$(document).ready(function () {
      $('#nilaiTable').DataTable({
        // opsi sesuai keinginan
      });
    });

	$(document).ready(function () {
      $('#kriteriaTable').DataTable({
        // opsi sesuai keinginan
      });
    });

	$(document).ready(function () {
      $('#pesananTable').DataTable({
        // opsi sesuai keinginan
      });
    });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Label pesanan
    const labelsPesanan = [
        {% for row in hasil %}"{{ row.pesanan.pelanggan.nama_pelanggan }}",{% endfor %}
    ];

    // Matriks Keputusan (X)
    const dataX = {
        labels: labelsPesanan,
        datasets: [
            {% for k in kriteria_list %}
            {
                label: "{{ k.nama_kriteria }}",
                data: [
                    {% for row in hasil %}{{ row.x|floatformat:2 }},{% endfor %}
                ],
                borderWidth: 1,
                backgroundColor: 'rgba(255, 99, 132, 0.5)'
            },
            {% endfor %}
        ]
    };

    new Chart(document.getElementById('chartX'), {
        type: 'bar',
        data: dataX,
        options: { responsive: true, scales: { y: { beginAtZero: true } } }
    });

    // Normalisasi (R)
    const dataR = {
        labels: labelsPesanan,
        datasets: [
            {% for k in kriteria_list %}
            {
                label: "{{ k.nama_kriteria }}",
                data: [
                    {% for row in hasil %}{{ row.r|join:"," }},{% endfor %}
                ],
                borderWidth: 1,
                backgroundColor: 'rgba(54, 162, 235, 0.5)'
            },
            {% endfor %}
        ]
    };

    new Chart(document.getElementById('chartR'), {
        type: 'bar',
        data: dataR,
        options: { responsive: true, scales: { y: { beginAtZero: true } } }
    });

    // Optimasi (Y)
    const dataY = {
        labels: labelsPesanan,
        datasets: [
            {% for k in kriteria_list %}
            {
                label: "{{ k.nama_kriteria }}",
                data: [
                    {% for row in hasil %}{{ row.y|join:"," }},{% endfor %}
                ],
                borderWidth: 1,
                backgroundColor: 'rgba(255, 206, 86, 0.5)'
            },
            {% endfor %}
        ]
    };

    new Chart(document.getElementById('chartY'), {
        type: 'bar',
        data: dataY,
        options: { responsive: true, scales: { y: { beginAtZero: true } } }
    });

    // Skor MOORA (Preferensi)
    const dataS = {
        labels: labelsPesanan,
        datasets: [{
            label: "Skor Preferensi",
            data: [{% for row in hasil %}{{ row.skor|floatformat:4 }},{% endfor %}],
            borderWidth: 1,
            backgroundColor: 'rgba(75, 192, 192, 0.5)'
        }]
    };

    new Chart(document.getElementById('chartS'), {
        type: 'bar',
        data: dataS,
        options: { responsive: true, scales: { y: { beginAtZero: true } } }
    });

    // Ranking Akhir
    const dataRank = {
        labels: [{% for row in ranking %}"{{ row.pesanan.pelanggan.nama_pelanggan }}",{% endfor %}],
        datasets: [{
            label: "Skor MOORA",
            data: [{% for row in ranking %}{{ row.skor|floatformat:4 }},{% endfor %}],
            borderWidth: 1,
            backgroundColor: 'rgba(153, 102, 255, 0.5)'
        }]
    };

    new Chart(document.getElementById('mooraChart'), {
        type: 'bar',
        data: dataRank,
        options: { responsive: true, scales: { y: { beginAtZero: true } } }
    });
</script>


  {% block extra_js %}
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>


{% endblock %}


</body>

</html>