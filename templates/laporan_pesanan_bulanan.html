{% extends 'base.html' %}

{% block title %}Laporan Pesanan Bulanan{% endblock %}

{% block content %}
<h2>Laporan Pesanan Bulanan</h2>

<form method="get" class="row g-3 mb-4">
    <div class="col-auto">
        <label for="bulan" class="form-label">Bulan</label>
        <select name="bulan" id="bulan" class="form-select">
            {% for b in bulan_list %}
            <option value="{{ b }}" {% if b == bulan %}selected{% endif %}>{{ b }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="col-auto">
        <label for="tahun" class="form-label">Tahun</label>
        <select name="tahun" id="tahun" class="form-select">
            {% for y in tahun_list %}
            <option value="{{ y }}" {% if y == tahun %}selected{% endif %}>{{ y }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="col-auto align-self-end">
        <button type="submit" class="btn btn-primary">Filter</button>
    </div>
</form>

<a href="{% url 'cetak_laporan_pesanan_bulanan' %}?bulan={{ bulan }}&tahun={{ tahun }}" target="_blank" class="btn btn-success mb-4">Cetak PDF</a>

<div class="card shadow-sm">
    <div class="card-header bg-primary text-white">
        <h5 class="mb-0">Daftar Pesanan Bulanan</h5>
    </div>
    <div class="card-body p-0">
        <table class="table table-hover mb-0">
            <thead class="table-light">
                <tr>
                    <th>No</th>
                    <th>Pelanggan</th>
                    <th>Jumlah Galon</th>
                    <th>Tanggal Pesan</th>
                    <th>Tanggal Pengiriman</th>
                </tr>
            </thead>
            <tbody>
                {% if pesanan %}
                    {% for p in pesanan %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ p.pelanggan.nama_pelanggan }}</td>
                        <td>{{ p.jumlah_galon }}</td>
                        <td>{{ p.tanggal_pesan|date:"d-m-Y" }}</td>
                        <td>{{ p.tanggal_pengiriman|date:"d-m-Y" }}</td>
                    </tr>
                    {% endfor %}
                {% else %}
                <tr>
                    <td colspan="5" class="text-center py-4">Data tidak ditemukan.</td>
                </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
